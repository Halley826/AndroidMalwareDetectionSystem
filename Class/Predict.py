#!/usr/bin/env python
# _*_ coding: utf-8 _*_
# @Time : 2021/12/27 10:01 PM
# @Author : Halley@https://github.com/Halley826/
# @Version：V 1.0
# @File : test.py
# @desc :导入模型，预测一个新的apk文件是否是恶意软件
test_single_dir ="/Users/halley/datasets/test/apk/benign/0a37f44ab538fce5885680975b2711e276d6dc0cb4f2b1f23b177ae79e5549a9.apk"
base_dir ="/Users/halley/OneDrive/code/python/own_project/jupyter/system/"
android_permission ="/Users/halley/OneDrive/code/python/own_project/pycharm/androidMalwareDetection/out/config/android_permission_100.txt"
from Class.APK import APK
# Press the green button in the gutter to run the script.
import joblib
if __name__ == '__main__':
    apk1 =APK(test_single_dir, android_permission)
    apk1.decode()
    permission_apk =apk1.permissionGet()
    permission_list_all =apk1.permissionTxtToList()
    vector =apk1.permissionVectorGet(permission_list_all, permission_apk)
    print(permission_apk)
    print(permission_list_all)
    print(vector)
    #apk1.permissionListToNpy()
    model=joblib.load(filename="../out/model/Adaboost_permission1227.gz")
    y=model.predict([vector])
    print("预测的结果:")
    if(y==[1]):
        print("非恶意软件")
    else:
        print("恶意软件")